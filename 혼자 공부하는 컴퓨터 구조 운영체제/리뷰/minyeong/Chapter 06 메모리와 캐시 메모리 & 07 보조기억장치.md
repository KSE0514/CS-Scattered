# Chapter 06 & 07. 메모리와 캐시 메모리 / 보조기억장치

# 06. 메모리와 캐시 메모리

## 06-1. RAM의 특징과 종류

### RAM의 특징

- 휘발성 저장 장치 : 전원을 끄면 **저장된 내용이 사라지는** 저장 장치
    - **RAM**
        - **실행할 대상** 저장
        - 실행하고픈 프로그램이 보조기억장치에 있다면 복사, 저장 후 실행
- 비휘발성 저장 장치 : 전원이 꺼져도 **저장된 내용이 유지**되는 저장 장치
    - **보조기억장치- 하드 디스크, SSD, USB 등
        - CPU 접근 불가
        - **보관할 대상** 저장
- RAM의 용량이 충분히 크다면 보조기억장치에서 많은 데이터 가져와 미리 저장 후 많은 프로그램을 동시에 실행하는데 유리 → 보조기억장치에서 여러 번 안 가져 와도 됨
    - 용량이 필요 이상으로 커졌을 때 속도가 비례하여 증가하진 않음

### RAM의 종류 (4)

1. DRAM (Dynamic RAM) : 시간이 지나면 저장된 데이터 점차 사라지는 RAM

- 특징
    - 데이터 소멸 막기 위해 일정 주기로 재활성화 필요
    - 일반적으로 사용하는 메모리
- 장점
    - 소비 전력 비교적 낮음
    - 저렴
    - 집적도 높음
    - 대용량 설계 용이
    

2. SRAM (Static RAM) : 시간이 지나도 저장된 데이터가 사라지지 않는 RAM

- 특징
    - 데이터 재활성화 필요 없음
    - 속도 빠름
    - 대용량은 아니지만 속도가 빨라야 하는 저장 장치
- 단점
    - 집적도 낮음
    - 소비 전력 큼
    - 가격 비쌈
    
3. SDRAM (Synchronous Dynamic RAM) : 클럭과 동기화된 DRAM

- 클럭에 맞춰 동작하며 클럭마다 CPU와 주고받을 수 있음

4. DDRSDRAM (Double Data Rate SDRAM) : 대역폭이 두 배 넓은 SDRAM

- SDR RDRAM * 2
- 대역폭 : 데이터를 주고받는 길의 너비
    - 한 클럭당 두 번씩 CPU와 데이터 주고 받을 수 있음
    - SDRAM 보다 전송 속도 두 배 가량 빠름
    - `SDRSDRAM` (Single Data Rate SDRAM) :한 클럭당 하나씩 데이터 주고 받을 수 있는 SDRAM
- DDR2 SDRAM
    - DDR SDRAM 보다 대역폭 두 배 넓은 SDRAM
    - SDR RDRAM * 4
- 최근 가장 흔히 사용됨

## 06-2. 메모리의 주소 공간

### 물리 주소와 논리 주소

**`물리 주소`** : 메모리 하드웨어가 사용하는 주소

**`논리 주소`** : CPU와 실행 중인 프로그램이 사용하는 주소

- CPU가 메모리와 상호 작용하려면 논리 주소와 물리 주소 간의 변환 필요
    - **메모리 관리 장치(MMU)**
        - CPU와 주소 버스 사이에 위치한 하드웨어
        - CPU가 발생 시킨 **논리 주소** + **베이스 레지스터 값** ⇒ **물리 주소로 변환**
            - 논리 주소 : 프로그램의 시작점으로부터 떨어진 거리
            - **`베이스 레지스터`** : 프로그램의 가장 작은 물리 주소(첫 물리 주소 저장)
        - EX) 베이스 레지스터 값(1500), 논리 주소(10) ⇒ 물리 주소 1510번지(1500 + 10)

### 메모리 보호 기법
- 논리 주소 범위를 벗어나는 명령어 실행을 방지하고, 실행 중인 프로그램이 다른 프로그램에 영향 받지 않도록 보호 필요 ⇒ **프로그램의 독립적인 실행 공간 확보, 다른 프로그램의 영역 침범 막기**
    - **`한계 레지스터`** : 논리 주소의 최대 크기 저장
- 논리 주소 < 한계 레지스터
    - 한계 레지스터 보다 높은 주소 값 접근 = 프로그램 범위에 벗어난 메모리 공간 접근
    - 접근 주소 검사 ⇒ 한계 레지스터 보다 높은 논리 주소면 인터럽트 발생시켜 실행 중단

## 06-3. 캐시 메모리

### 저장 장치 계층 구조

: 각기 다른 용량과 성능의 저장 장치들을 계층화하여 표현한 구조

- 명제
    1. CPU와 가까운 저장 장치는 빠르고, 멀리 있는 저장 장치는 느리다.
    2. 속도가 빠른 저장 장치는 저장 용량이 작고, 가격이 비싸다.
- 기준 : 저장 장치가 CPU에 얼마나 가까운가

### 캐시 메모리

: CPU의 연산속도와 메모리 접근 속도의 차이를 줄이기 위한 저장 장치

### 캐시 메모리 특징

- CPU와 메모리 사이에 위치
- 레지스터보다 용량 크고, 메모리보다 빠른 SRAM 기반의 저장 장치
- 메모리에서 CPU가 사용할 일부 데이터를 미리 가지고 와 활용
- CPU에 가까운 순서대로 계층 구성
    - L1 (level 1) 캐시 - L2 캐시 - L3 캐시
        - 일반적으로 L1 캐시,  L2 캐시는 코어 내부, L3 코어 외부에 위치
        - 메모리 용량 : L1 캐시 < L2 캐시 < L3 캐시 (커짐)
        - 속도 : L3 캐시 < L2 캐시 < L1 캐시 (빠름)
        - 가격 : L3 캐시 < L2 캐시 < L1 캐시 (비)
    - 멀티 코어 프로세서
        - L1 캐시, L2 캐시 - 코어마다 고유한 캐시 메모리 할당
        - L3 캐시 : 여러 코어가 공유하는형태
        - 분리형 캐시
            - L1 캐시를 L1I 캐시(명령어만 저장)와 L1D 캐시(데이터만 저장)로 분리
            - 접근 속도 빠르게 만들기 위해
            

#### 참조 지역성 원리

<aside>
‼️ 용어 정리

- **`캐시 히트`** : 자주 사용될 것으로 예측한 데이터가 실제로 CPU에서 활용될 경우
- **`캐시 미스`** : 예측이 틀려 메모리에서 필요한 데이터를 직접 가져와야 하는 경우
- **`캐시 적중률`** : 캐시가 히트되는 비율
    - 캐시 히트 횟수 / (캐시 히트 횟수 + 캐시 미스 횟수)
    - 캐시 적중률 높으면 CPU의 메모리 접근 횟수 줄일 수 있음
</aside>

- 캐시 메모리는 메모리 보다 용량 작기 때문에 CPU가 사용할 법한 대상 예측하여 저장
- 참조 지역성 원리에 의해 메모리로부터 가져올 데이터 결정
    - 참조 지역성 원리 : CPU가 메모리에 접근할 때 주된 경향을 바탕으로 만들어진 원리
        1. 시간 지역성 : CPU는 최근에 접근했던 메모리 공간에 다시 접근하려는 경향이 있다.
        2. 공간 지역성 : CPU는 접근한 메모리 공간 근처를 접근하려는 경향이 있다.
        
---

# 07. 보조기억장치

## 07-1. 다양한 보조기억장치

### 하드 디스크

: 자기적인 방식으로 데이터를 저장하는 보조기억장치
- 자기 디스크의 일종

#### 구성 요소

- `플래터` : 실질적으로 데이터가 저장되는 곳, 자기 물질로 덮여 있어 수많은 N극(0), S극(1) 저장
    - `트랙` : 플래터를 **여러 동심원으로 나눴을 때** 그 중 하나의 원
    - `섹터` : 트랙를 이루는 하나의 조각, 하드 디스크의 가장 작은 전송 단위, 일반적으로 512바이트
        - `블록` : 하나 이상의 섹터
        - `실린더` : 여러 겹의 플래터 상 **같은 트랙이 위한 곳**을 모아 연결한 논리적 단위
            - 연속된 정보는 한 실린더에 기록 → 디스크 암을 움직이지 않고 바로 접근 가능            
- `헤드` : 플래터 대상으로 데이터 읽고 쓰는 구성 요소, 디스크 암에 부착
- `디스트 암` : 헤드를 원하는 위치로 이동시킴
- `스핀들` : 플래터 회전시키는 구성 요소
- `RPM` : 스핀들이 플래터를 돌리는 속도, 분당 회전수

#### 하드 디스크가 저장된 데이터에 접근하는 시간

- 탐색 시간 : 접근하려는 데이터가 저장된 트랙까지 헤드를 이동시키는 시간
- 회전 지연 : 헤드가 있는곳으로 플래터를 회전시키는 시간
- 전송 시간: 하드 디스크와 컴퓨터 간 데이터를 전송하는 시간

#### 특징

- 많은 데이터 저장을 위해 여러 겹의 플래터로 이루어짐
- 양면 플래터는 위아래로 플래터당 두 개의 헤드 사용
- 모든 헤드는 디스크 암에 부착

- **참고 - 다중 헤드 디스크와 고정 헤드 디스크**
    - 단일 헤드 디스크 (이동 헤드 디스크)
        - 플래터의 한 면당 헤드가 하나씩 달려 있는 하드 디스크
    - 다중 헤드 디스크 (고정 헤드 디스크)
        - 헤드가 트랙별로 여러 개 달려 있는 하드 디스크
        - 트랙마다 헤드가 있어 탐색 시간 없음 ⇒ **탐색 시간 : 0**
    

### 플래시 메모리
: 전기적으로 데이터를 읽고 쓸 수 있는 반도체 기반의 저장 장치
- USB 메모리, SD 카드, SSD
- 플래시 메모리 종류
    - **NAND 플래시 메모리**
        - NAND 연산을 수행하는 회로(NAND 게이트)를 기반으로 만들어진 메모리
        - 대용량 저장 장치로 많이 사용
        - 앞으로 설명될 플래시 메모리
    - **NOR 플래시 메모리**
        - NOR 연산을 수행하는 회로(NOR 게이트)를 기반으로 만들어진 메모리

#### 플래시 메모리 타입 (3)

<aside>
💽 셀

- 플래시 메모리에서 데이터를 저장하는 가장 작은 단위
- 하나의 셀에 몇 비트를 저장할 수 있느냐
    - `SLC` (Single Level Cell) : 한 셀에 1비트 저장
    - `MLC` (Multi Level Cell) : 한 셀에 2비트 저장
    - `TLC` (Triple Level Cell) : 한 셀에 3비트 저장
    
</aside>

- SLC 타입
    
    
    |                                         **장점** |                                        **단점** |
    | --- | --- |
    | - 비트의 빠른 입출력 | -용량 대비 높은 가격 |
    | - 수명 긺 |  |
    - 한 셀로 2개의 정보 표현
    - 데이터 읽고 쓰기가 많이 반복, 고성능의 빠른 저장 장치 필요한 경우에 사용

- MLC 타입
    
    
    |                                         **장점** |                                        **단점** |
    | --- | --- |
    | - SLC에 비해 대용화 유리 | - SLC에 비해 떨어지는 속도, 수명 |
    | - 용량 대비 가격 저렴 |  |
    - 한 셀로 4개의 정보 표현
    - 시중에서 사용되는 플래시 메모리 저장 장치

- TLC 타입
    
    
    |                                         **장점** |                                        **단점** |
    | --- | --- |
    | - 대용화 유리 | - 떨어지는 속도, 수명 |
    | - 용량 대비 가격 저렴 |  |
    - 한 셀로 8개의 정보 표현
    - 저가의 대용량 장치

#### 플래시 메모리 단위

- `셀`
- `페이지` : 셀 모여서 만들어진 단위 ⇒ 읽기/쓰기
    - Free 상태 : 어떠한 데이터도 저장하고 있지 않아 새로운 데이터를 저장할 수 있는 상태
    - Valid 상태 : 이미 유효한 데이터를 저장하고 있는 상태, 덮어쓰기 불가능(새 데이터 저장 불가)
    - Invalid 상태 : 유효하지 않은 데이터를 저장하고 있는 상태
    - 참고 - 가비지 컬렉션 (garbagge collection)
        - 유효한 페이지들만 새로운 블록으로 복사
        - 기존의 블록 삭제
- `블록` : 페이지 모여 만들어진 단위 ⇒ 삭제
- `플레인` : 블록이 모여 만들어진 단위
- `다이` : 플레인 모여 만들어진 단위

## 07-2. RAID의 정의와 종류

### RAID의 정의

: Redundant Array of Independent Disks

: 데이터의 안전성 혹은 높은 성능을 위해 여러 하드 디스크나 SSD를 **마치 하나의 (논리적 보조기억) 장치처럼** 사용하는 기술

### RAID의 종류 (5)

<aside>
🎚️RAID 레벨 : RAID 구성 방법

- RAID 0
- RAID 1
- RAID 2 - 현재 잘 활용되지 않음
- RAID 3 - 현재 잘 활용되지 않음
- RAID 4
- RAID 5
- RAID 6
</aside>

#### RAID 0

: 여러 개의 보조기억장치에 데이터를 단순히 나누어 저장하는 구성 방식
- `스트라입` : 줄무늬처럼 분산되어 저장된 데이터
- `스트라이핑` : 분산하여 저장하는 것
    - 저장된 데이터를 읽고 쓰는 속도가 빨라짐
- 단점
    - 저장된 정보의 불안전 → 하나에 문제 생기면 다른 모든 하드 디스크의 정보를 읽는데 문제 생길 수 있기 때문

#### RAID 1
:  완전한 복사본 만드는 방식 ⇒ **미러링**

- 원본, 복사본에 데이터를 쓰기 때문에 속도는 RAID 보다 느림
- 장점
    - 복구 매우 간단
- 단점
    - 하드 디스크 개수가 한정되었을 때 사용 가능한 용량 적어짐
    - 많은 양의 하드 디스크 필요하고, 비용 증가

#### RAID 4
: 오류 검출하고 복구하기 위한 정보를 저장한 장치를 두는 구성 방식

- `패리티 비트` : 오류를 검출하고 복구하기 위한 정보
    - 본래 오류 검출용 정보지만, RAID에서는 오류 복구도 가능
- 장점
    - 패리티 저장 장치를 이용해 다른 장치들의 오류 검출 및 복구 → RAID 1 보다 적은 하드 디스크로도 데이터 안전하게 보관 가능
- 단점
    - 새로운 데이터가 저장될 때마다 패리티 저장 디스크에도 데이터를 써 패리티를 저장하는 장치에 병목 현상 발생

#### RAID 5
: 패리티 정보 분산해 저장하는 방식

#### RAID 6
: 서로 다른 두 개의 패리티를 두는  방식

- 장점
    - 오류 검출 및 복구 수단이 2개 → RAID4/5보다 안전한 구성
- 단점
    - 쓰기 속도 RAID 5 보다 느림 → 새로운 정보 저장할 때마다 저장할 패리티도 2개

- **참고 - Nested RAID**
    - 여러 RAID 레벨을 혼합한 방식
        - RAID 10 = RAID 0 + RAID 1
        - RAID 50 = RAID 0 + RAID 5