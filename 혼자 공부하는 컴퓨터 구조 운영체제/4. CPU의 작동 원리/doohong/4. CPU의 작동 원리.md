# 혼자 공부하는 컴퓨터 구조 운영체제 

- [혼자 공부하는 컴퓨터 구조 운영체제](#혼자-공부하는-컴퓨터-구조-운영체제)
- [4. ALU와 제어장치](#4-alu와-제어장치)
  - [ALU와 제어장치](#alu와-제어장치)
    - [1장 상기하기](#1장-상기하기)
    - [ALU](#alu)
      - [ALU가 받아들이는 정보](#alu가-받아들이는-정보)
      - [ALU가 내보내는 정보](#alu가-내보내는-정보)
    - [제어장치](#제어장치)
      - [제어장치가 받아들이는 정보](#제어장치가-받아들이는-정보)
        - [1. 제어장치는 클럭 신호를 받아들임](#1-제어장치는-클럭-신호를-받아들임)
      - [2. 제어장치는 '해석해야 할 명령어'를 받아들임](#2-제어장치는-해석해야-할-명령어를-받아들임)
        - [3. 제어장치는 플래그 레지스터 속 플래그 값을 받아들임](#3-제어장치는-플래그-레지스터-속-플래그-값을-받아들임)
        - [4. 제어장치는 시스템 버스 중 제어 버스로 전달된 제어 신호를 받아들임](#4-제어장치는-시스템-버스-중-제어-버스로-전달된-제어-신호를-받아들임)
      - [제어장치가 내보내는 정보](#제어장치가-내보내는-정보)
        - [1. CPU 외부에 전달하는 제어 신호](#1-cpu-외부에-전달하는-제어-신호)
        - [2. CPU 내부로 전달하는 제어 신호](#2-cpu-내부로-전달하는-제어-신호)
  - [레지스터](#레지스터)
    - [1장 회상하기](#1장-회상하기)
    - [반드시 알아야 할 레지스터](#반드시-알아야-할-레지스터)
      - [1. 프로그램 카운터](#1-프로그램-카운터)
      - [2. 명령어 레지스터](#2-명령어-레지스터)
      - [3. 메모리 주소 레지스터](#3-메모리-주소-레지스터)
      - [4. 메모리 버퍼 레지스터](#4-메모리-버퍼-레지스터)
      - [5. 플래그 레지스터](#5-플래그-레지스터)
      - [6. 범용 레지스터](#6-범용-레지스터)
      - [7. 스택 포인터](#7-스택-포인터)
      - [8. 베이스 레지스터](#8-베이스-레지스터)
    - [특정 레지스터를 이용한 주소 지정 방식](#특정-레지스터를-이용한-주소-지정-방식)
      - [1. 스택 주소 지정 방식](#1-스택-주소-지정-방식)
      - [2. 변위 주소 지정 방식](#2-변위-주소-지정-방식)
        - [2-1. 상대 주소 지정 방식](#2-1-상대-주소-지정-방식)
        - [2-2. 베이스 레지스터 주소 지정 방식](#2-2-베이스-레지스터-주소-지정-방식)
  - [Q\&A](#qa)
    - [Q1. ALU가 레지스터에 101이라는 결과값과 부호 플래그 1을 넘겨주었다. 결과를 십진수로 말하고 어떻게 그 값이 나오는지 설명하시오.](#q1-alu가-레지스터에-101이라는-결과값과-부호-플래그-1을-넘겨주었다-결과를-십진수로-말하고-어떻게-그-값이-나오는지-설명하시오)
    - [Q2. 제어장치가 받아들이는 정보와 내보내는 정보를 설명하시오.](#q2-제어장치가-받아들이는-정보와-내보내는-정보를-설명하시오)
    - [Q3. 8가지 레지스터 종류를 말하고 간단한 설명을 하시오.](#q3-8가지-레지스터-종류를-말하고-간단한-설명을-하시오)


# 4. ALU와 제어장치
## ALU와 제어장치
### 1장 상기하기
- CPU : 메모리에 저장된 명령어를 읽어 들이고, 해석하고, 실행하는 장치
- CPU 내부
  - ALU : 내부 계산을 담당
  - 제어장치 : 명령어를 읽어 들이고 해석
  - 레지스터 : 작은 임시 저장 장치
![Alt text](<CPU 내부.png>)

### ALU
- ALU의 정보를 받아들이고 내보내는 과정
![!\[Alt text\](image.png)](<ALU 구조.png>)
  - ALU = 계산하는 부품

#### ALU가 받아들이는 정보
- 계산하기 위해서 피연산자와 수행할 연산이 필요
- ALU가 연산과 피연산자를 받아들이는 방법
  - **레지스터**를 통해 **피연산자**를 받아들임
  - **제어장치**로부터 수행할 **연산**을 알려주는 **제어 신호**를 받아들임
  > 레지스터와 제어장치로부터 받아들인 피연산자와 제어 신호로 산술 연산, 논리 연산 등 다양한 연산을 수행

#### ALU가 내보내는 정보
- 연산을 수행한 결과(특정 숫자, 문자, 메모리 주소 등)는 일시적으로 레지스터에 저장 후 메모리 저장
  - 메모리가 CPU에 접근하는 속도 > CPU가 레지스터에 접근하는 속도
    - 매번 결과를 메모리에 저장하게 된다면 접근 속도가 훨씬 더 오래 걸리기 때문에 프로그램 실행 속도가 늦어짐
- 계산과 함께 **플래그**를 내보냄
  - 결과값뿐 아니라 연산 결과에 대한 추가적인 정보를 보내야할 때 사용
  - 플래그 레지스터에 저장됨
  - 예시 
    - 연산 결과가 음수 일 때 '음수'라는 추가 정보를 보내야 함
    - 연산 결과가 레지스터보다 클 때 '결과 값이 너무 크다'라는 추가 정보를 내보내야 함 (overflow)

|플래그 종류|의미|사용 예시|
|:--------:|:---:|:-----:|
|부호 플래그|연산한 결과의 부호를 나타냄|- 1일 경우 계산 결과는 음수 <br> - 0일 경우 계산 결과는 양수를 의미|
|제로 플래그|연산 결과가 0인지 여부를 나타냄|- 1일 경우 연산 결과는 0 <br> - 0일 경우 연산결과는 0이 아님|
|캐리 플래그|연산 결과 올림수나 빌림수가 발생했는지를 나타냄|- 1일 경우 올림수나 빌림수 발생 <br> - 0일 경우 발생 안함|
|오버플로우 플래그|오버플로우가 발생했는지를 나태냄|- 1일 경우 오버플로우 발생 <br> - 0일 경우 발생 안함|
|인터럽트 플래그|인터럽트가 가능한지를 나타냄|- 1일 경우 인터럽트 가능 발생 <br> - 0일 경우 인터럽트 불가능|
|슈퍼바이저 플래그|커널 모드로 실행 중인지, 사용자 모드로 실행 중인지를 나태냄|- 1일 경우 커널 모드로 실행 중 <br> - 0일 경우 사용자 모드로 실행 중|

### 제어장치
- 제어장치 : 제어 신호를 내보내고 명령어를 해석하는 부품
- 제어 신호 : 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기 신호
- CPU의 제조사마다 제어장치의 구현 방식이나 명령어를 받아들이고 해석하며 내보내는 가장 방식이 다름
- 제어장치의 역할을 이해하는 것이 중요
![Alt text](<제어장치 역할.png>)

#### 제어장치가 받아들이는 정보
##### 1. 제어장치는 클럭 신호를 받아들임
- 클럭(clock)이란?
  - 컴퓨터의 모든 부품을 움직일 수 있게 하는 시간 단위
  - 클럭의 주기에 맞춰 레지스터끼리 데이터가 이동되거나, ALU에서 연산이 수행됨  
  => CPU가 메모리에 저장된 명령어를 읽어 들이는 것
  - 클럭이라는 박자에 맞춰 모든 컴퓨터의 부품들이 작동됨
  - 각자 다른 클럭 주기에 맞춰 명령어가 실행될 수 있음

#### 2. 제어장치는 '해석해야 할 명령어'를 받아들임
- 명령어 레지스터 : CPU가 해석해야 할 명령어가 저장되는 곳
=> 제어장치는 명령어 레지스터로부터 해석할 명령어를 받아들이고 해석한 뒤, 제어 신호를 발생시켜 컴퓨터 부품들에 수행해야 할 내용을 알려줌

##### 3. 제어장치는 플래그 레지스터 속 플래그 값을 받아들임
- ALU의 추가적인 상태 정보를 가지고 있는 플래그 값을 받아들이고 참고하여 제어 신호를 발생시킴

##### 4. 제어장치는 시스템 버스 중 제어 버스로 전달된 제어 신호를 받아들임
- CPU, 입출력장치와 같은 외부 장치도 제어 신호를 발생시킬 수 있음
- 제어장치는 제어 버스를 통해 외부로부터 전달된 제어 신호를 받아들이기도 함

> 제어장치는 클럭, 현재 수행할 명령어(from 명령어 레지스터), 플래그(from 플래그 레지스터), 제어 신호(from CPU, 외부 장치)

#### 제어장치가 내보내는 정보
##### 1. CPU 외부에 전달하는 제어 신호
- 제어 버스로 제어 신호를 내보내는 것
- 메모리에 전달하는 제어 신호, 입출력장치(보조기억장치)에 전달하는 제어 신호가 있음

<br>

- 제어 장치 => 메모리
- 제어 장치 => 입출력 장치  
=> 값을 읽거나 쓰고 싶을 때 제어 신호를 보냄

##### 2. CPU 내부로 전달하는 제어 신호
- ALU에 수행할 연산을 지시하기 위해 제어 신호 전달
- 레지스터에 레지스터 간 데이터를 이동시키거나 레지스터에 저장된 명령어를 해석하기 위해 제어 신호 전달


---
[목차로 돌아가기](#)

---

## 레지스터
### 1장 회상하기
- 명령어와 데이터는 샐행 전후로 레지스터에 저장됨
- 다양한 레지스터가 있고 각자 다른 역할을 함

### 반드시 알아야 할 레지스터
- CPU마다 이름, 크기, 종류가 다양함
- 대부분 공통으로 포함하고 있는 8개의 레지스터가 존재

#### 1. 프로그램 카운터
- 메모리에서 가져올 명령어의 주소
- 메모리에서 읽어들일 명령어의 주소를 저장
- 명령어 포인터라고 부르는 CPU도 존재
- 변위 주소 지정 방식에 사용됨

#### 2. 명령어 레지스터
- 해석할 명령어를 메모리에서 읽어 들이고 저장하는 레지스터
- 제어 장치는 명령어 레지스터 속 명령어를 받아들이고 해석한 뒤 제어 신호를 내보냄

#### 3. 메모리 주소 레지스터
- 메모리 주소를 저장하는 레지스터
- CPU가 읽어들이고자 하는 주소 값을 주소 버스로 보낼 때 메모리 주소 레지스터를 거치게 됨

#### 4. 메모리 버퍼 레지스터
- 메모리가 주고 받을 값(데이터와 명령어)를 저장하는 레지스터
- CPU가 데이터 버스로 주고 받을 값은 메모리 버퍼 레지스터를 거침
- 메모리 데이터 레지스터라고도 부르기도 함

#### 5. 플래그 레지스터
- ALU 연산 결과에 따른 플래그 또는 CPU 상태에 대한 부가적인 정보를 저장하는 레지스터

#### 6. 범용 레지스터
- 다양하고 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터
- 데이터와 주소를 모두 저장할 수 있음

#### 7. 스택 포인터
- 스택 주소 지정 방식이라는 주소 지정 방식에 사용됨

#### 8. 베이스 레지스터
- 변위 주소 지정 방식에 사용됨

### 특정 레지스터를 이용한 주소 지정 방식
#### 1. 스택 주소 지정 방식
- 스택 주조 지정 방식이란?
  - 스택과 스택 포인터를 이용한 주소 지정 방식
  - 한쪽 끝이 막혀있는 통과 같은 저장 공간
  - 최근 저장하는 값부터 꺼낼 수 있음
- 스택포인터란?
  - 스택에 마지막으로 저장한 값의 위치를 저장하는 레지스터
  - 스택의 어디까지 데이터가 채워져 있는지에 대한 표시
- 스택이란?
  - 메모리 안에 있는 사용할 영역 => 스택 영역

#### 2. 변위 주소 지정 방식
- 변위 주소 지정 방식이란?
  - 오퍼랜드 필드의 값(변위)과 특정 레지스터의 값을 더하여 **유효 주소**를 얻어내는 주소 지정 방식  
  => 오퍼랜드 필드와 어떤 레지스터를 더하는지에 따라 **상대 주소 지정 방식**, **베이스 레지스터 주소 지정 방식** 등 나뉨

##### 2-1. 상대 주소 지정 방식
- 오퍼랜드와 프로그램 카운터의 값을 더하여 유효 주소를 얻는 방식
- 프로그램 카운터에 읽어 들일 명령어 주소가 저장되어 있음
- 예 
  - 프로그램 카운터 : -3 = CPU를 읽어 들이기로 한 명령어로부터 세번째 이전 번지로 접근 
- 모든 코드를 실행하는 것이 아닌 분기하여 특정 주소의 코드를 실행할 때 사용됨

##### 2-2. 베이스 레지스터 주소 지정 방식
- 오퍼랜드와 베이스 레지스터의 값을 더하여 유효 주소를 얻는 방식
- 베이스 레지스터 : 기준 주소
- 오퍼랜드 : 기준 주소로부터 떨어진 거리
- 예
  - 베이스 레지스터 : 200, 오퍼랜드 : 40 
  => 기준 주소 200번지로부터 40만큼 떨어진 240번지로 접근

---
[목차로 돌아가기](#)

---
## Q&A
### Q1. ALU가 레지스터에 101이라는 결과값과 부호 플래그 1을 넘겨주었다. 결과를 십진수로 말하고 어떻게 그 값이 나오는지 설명하시오.
A1. 부호 플래그가 1이라는 것은 음수를 의미하기 때문에 2의 보수를 취해야 합니다. 101의 2의 보수를 취하면 011이며 이를 십진수로 변환하면 3이 됩니다. 여기에 음수를 나타내는 -를 붙이면 결과값으로 -3이 나오게 됩니다.

### Q2. 제어장치가 받아들이는 정보와 내보내는 정보를 설명하시오.
A2. 제어버스가 받아들이는 정보로는 플래그 레지스터의 플래그, 명령어 레지스터에서 명령어, 컴퓨터 부품들의 움직이는 시간 단위인 클럭 신호, 외부에서 오는 제어 신호들을 받아들입니다.  

제어버스가 내보내는 정보는 내부와 외부로 나눠집니다. 내부에 내보내는 정보는 ALU가 수행할 연산을 지시하는 제어 신호와 레지스터의 데이터 이동 또는 명령어 해석을 위한 제어 신호를 전달합니다.  
외부에 내보내는 정보는 제어 버스를 통해 메모리나 입출력장치에 제어 신호를 보내기도 합니다.

### Q3. 8가지 레지스터 종류를 말하고 간단한 설명을 하시오.
A3. 프로그램 카운터는 메모리에서 가져올 명령어의 주소를 저장하고 있는 레지스터입니다. 명령어 레지스터는 해석할 명령어를 메모리에서 읽어 들이고 저장하는 레지스터입니다. 메모리 주소 레지스터는 읽어들일 메모리 주소를 저장하는 레지스터입니다. 메모리 버퍼 레지스터는 메모리가 주고 받을 데이터와 명령어를 저장하는 레지스터입니다. 플래그 레지스터는 ALU 연산 결과에 따른 플래그 또는 CPU 상태에 대한 부가 정보를 저장하는 레지스터입니다. 범용 레지스터는 일반적인 상황에서 데이터와 주소를 모두 저장하는 레지스터입니다. 스택 포인터는 스택 주조 지정 방식에서 사용되는 스택의 마지막 저장된 값 위치를 나타내는 레지스터입니다. 베이스 레지스터는 변위 주소 지정 방식에 사용되며 기준 주소를 저장하는 레지스터입니다.

---
[목차로 돌아가기](#)

---